// SPDX-FileCopyrightText: 2024 Panoptes Contributors
// SPDX-License-Identifier: MIT
= Installation Guide
:toc: left
:toclevels: 3
:icons: font
:source-highlighter: rouge

This guide covers all installation methods for Panoptes.

== System Requirements

=== Minimum Requirements

* **OS**: Linux (x86_64, aarch64), macOS (Intel, Apple Silicon), Windows 10+
* **RAM**: 4GB
* **Disk**: 3GB (including Ollama and model)
* **CPU**: Any modern processor

=== Recommended Requirements

* **RAM**: 8GB or more
* **Disk**: SSD for faster database operations
* **GPU**: Optional, but speeds up AI inference

== Installation Methods

=== Pre-built Binaries

Download from the releases page:

[source,bash]
----
# Linux (x86_64)
curl -LO https://github.com/yourusername/panoptes/releases/latest/download/panoptes-linux-x86_64.tar.gz
tar xzf panoptes-linux-x86_64.tar.gz
sudo mv panoptes /usr/local/bin/

# macOS (Universal)
curl -LO https://github.com/yourusername/panoptes/releases/latest/download/panoptes-macos-universal.tar.gz
tar xzf panoptes-macos-universal.tar.gz
sudo mv panoptes /usr/local/bin/
----

=== Using Cargo

Install from crates.io:

[source,bash]
----
cargo install panoptes
----

With specific features:

[source,bash]
----
# With web dashboard
cargo install panoptes --features web

# All features
cargo install panoptes --all-features

# Minimal (no optional features)
cargo install panoptes --no-default-features
----

=== From Source

Clone and build:

[source,bash]
----
git clone https://github.com/yourusername/panoptes.git
cd panoptes

# Debug build
cargo build

# Release build
cargo build --release

# Install to ~/.cargo/bin
cargo install --path .
----

=== Using Nix

With flakes enabled:

[source,bash]
----
# Run without installing
nix run github:yourusername/panoptes -- scan ~/Downloads

# Install to profile
nix profile install github:yourusername/panoptes

# Development shell
nix develop github:yourusername/panoptes
----

Add to your NixOS configuration:

[source,nix]
----
{
  inputs.panoptes.url = "github:yourusername/panoptes";

  # ... in your configuration
  environment.systemPackages = [ inputs.panoptes.packages.${system}.default ];
}
----

=== Using Container

[source,bash]
----
# Podman
podman pull ghcr.io/yourusername/panoptes:latest

# Docker
docker pull ghcr.io/yourusername/panoptes:latest

# Run
podman run -it --rm \
  -v ~/.local/share/panoptes:/data \
  -v ~/Downloads:/files:ro \
  ghcr.io/yourusername/panoptes scan /files
----

== Installing Ollama

Panoptes requires Ollama for AI features.

=== Linux

[source,bash]
----
curl -fsSL https://ollama.ai/install.sh | sh
----

=== macOS

[source,bash]
----
brew install ollama
----

Or download from https://ollama.ai

=== Windows

Download installer from https://ollama.ai

=== Verify Ollama

[source,bash]
----
ollama --version
----

== Pulling the AI Model

After installing Ollama:

[source,bash]
----
# Start Ollama (if not already running)
ollama serve &

# Pull Moondream model (~1.6GB)
ollama pull moondream

# Verify
ollama list
----

== Shell Completions

Generate completions for your shell:

[source,bash]
----
# Bash
panoptes shell completions bash > ~/.local/share/bash-completion/completions/panoptes

# Zsh
panoptes shell completions zsh > ~/.zfunc/_panoptes

# Fish
panoptes shell completions fish > ~/.config/fish/completions/panoptes.fish

# PowerShell
panoptes shell completions powershell > $PROFILE.CurrentUserAllHosts
----

== Verifying Installation

Run these commands to verify everything is working:

[source,bash]
----
# Check Panoptes version
panoptes --version

# Check Ollama connection
panoptes system check

# Run a test scan
panoptes scan ~/Pictures --dry-run
----

== Uninstalling

=== Cargo Installation

[source,bash]
----
cargo uninstall panoptes
----

=== Manual Cleanup

[source,bash]
----
# Remove binary
rm $(which panoptes)

# Remove data (optional)
rm -rf ~/.local/share/panoptes

# Remove config (optional)
rm -rf ~/.config/panoptes
----

== Troubleshooting

=== Build Failures

Ensure you have build dependencies:

[source,bash]
----
# Ubuntu/Debian
sudo apt install build-essential pkg-config libssl-dev

# Fedora
sudo dnf install gcc pkg-config openssl-devel

# macOS
xcode-select --install
----

=== Ollama Connection Issues

1. Ensure Ollama is running: `ollama serve`
2. Check the default port: `curl http://localhost:11434/api/version`
3. Set custom URL: `export PANOPTES_OLLAMA_URL=http://host:port`

=== Permission Denied

Ensure the binary is executable:

[source,bash]
----
chmod +x /path/to/panoptes
----
