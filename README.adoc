// SPDX-FileCopyrightText: 2024 eTMA Handler Contributors
// SPDX-License-Identifier: MIT
= eTMA Handler
:toc: left
:toclevels: 3
:icons: font
:source-highlighter: rouge
:experimental:
:sectnums:

image:https://img.shields.io/badge/version-2.0.0-blue[Version]
image:https://img.shields.io/badge/license-MIT-green[License]
image:https://img.shields.io/badge/RSR-Gold-gold[RSR Gold]

**Mark Open University assignments without the pain.**

== Quick Start

=== One Command Install

[source,bash]
----
# Linux/macOS
curl -fsSL https://raw.githubusercontent.com/Hyperpolymath/tma-mark2/main/setup.sh | bash

# Windows (PowerShell)
irm https://raw.githubusercontent.com/Hyperpolymath/tma-mark2/main/setup.ps1 | iex
----

=== Or Just Run It

If you have https://podman.io[Podman] installed:

[source,bash]
----
podman run -p 4000:4000 -v ~/.local/share/etma_handler:/data ghcr.io/hyperpolymath/etma-handler
----

Then open http://localhost:4000

=== Or Clone and Go

[source,bash]
----
git clone https://github.com/Hyperpolymath/tma-mark2.git
cd tma-mark2
just do-it
----

That's it. `just do-it` handles everything.

== What You Need

* **Podman** - That's it. The container has everything else.

[cols="1,2"]
|===
|Platform |Install Podman

|Fedora |`sudo dnf install podman`
|Ubuntu |`sudo apt install podman`
|Arch |`sudo pacman -S podman`
|macOS |`brew install podman`
|Windows |`winget install RedHat.Podman`
|===

== What This Is

eTMA Handler replaces the legacy Java marking tool for Open University tutors:

[cols="1,1"]
|===
|Old Java Tool |eTMA Handler

|Windows only |Linux, macOS, Windows
|Requires Java 6 |Requires nothing (container)
|Word-dependent |Built-in annotation
|Clunky file handler |Drag and drop
|Manual PT3 forms |Auto-generated
|No batch release |Release all at once
|===

== Commands

[source,bash]
----
just do-it      # Set everything up and run
just start      # Run in background
just stop       # Stop the container
just update     # Update to latest version
just backup     # Backup your data
just logs       # View logs
just status     # Check if running
----

== Your Data

Your data stays on your machine:

[source]
----
Linux/macOS: ~/.local/share/etma_handler/
Windows:     %APPDATA%\etma_handler\
----

Override with: `ETMA_DATA_DIR=/your/path just do-it`

== For Developers

If you want to hack on the code:

[source,bash]
----
# Enter dev environment (requires Nix)
nix develop

# Or install Elixir and run
mix deps.get
mix phx.server
----

Development requires:

* Elixir 1.16+ / OTP 26+
* Node.js 20+
* Or just use: `nix develop`

== How It Works

[source]
----
┌─────────────────────────────────────────────────────────────┐
│                     Your Computer                            │
│  ┌─────────────────────────────────────────────────────┐    │
│  │              Podman Container                        │    │
│  │  ┌─────────────┬─────────────┬──────────────┐       │    │
│  │  │   Phoenix   │   Elixir    │    CubDB     │       │    │
│  │  │  LiveView   │   Logic     │   Storage    │       │    │
│  │  └─────────────┴─────────────┴──────────────┘       │    │
│  │               Wolfi Base (minimal)                   │    │
│  └─────────────────────────────────────────────────────┘    │
│                            │                                 │
│                    ┌───────┴───────┐                        │
│                    ▼               ▼                        │
│              http://localhost:4000                          │
│               ~/.local/share/etma_handler (your data)       │
└─────────────────────────────────────────────────────────────┘
----

The container bundles:

* Wolfi base (minimal, secure)
* Erlang/OTP runtime
* Elixir release
* Phoenix web app
* All dependencies

Your data lives outside the container. Update the container, keep your data.

== Documentation

* link:ROADMAP.md[Roadmap] - Where we're going
* link:CONTRIBUTING.adoc[Contributing] - How to help
* link:SECURITY.md[Security] - Vulnerability reporting
* link:docs/COMPETITORS.md[Competitors] - Market analysis
* link:docs/IDEAS.md[Ideas] - Innovation brainstorm
* link:CLAUDE.adoc[AI Guide] - For AI assistants

== License

MIT License - see link:LICENSE.txt[LICENSE.txt]

== Acknowledgements

* The Open University for the original (and the pain that inspired this)
* The Elixir and Phoenix communities
* Chainguard for Wolfi
* Every tutor who's ever rage-quit the Java tool
