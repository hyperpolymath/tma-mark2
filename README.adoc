// SPDX-FileCopyrightText: 2024 eTMA Handler Contributors
// SPDX-License-Identifier: MIT
= eTMA Handler
:toc: left
:toclevels: 3
:icons: font
:source-highlighter: rouge
:experimental:
:sectnums:

[.text-center]
--
[source,bash]
----
curl -fsSL https://hyperpolymath.github.io/tma-mark2/install | bash
----

**That's it.** Open http://localhost:4000 and start marking.

image:https://img.shields.io/badge/version-2.0.0-blue[Version]
image:https://img.shields.io/badge/license-MIT-green[License]
image:https://img.shields.io/badge/RSR-Gold-gold[RSR Gold]
image:https://img.shields.io/badge/crypto-post--quantum-purple[Post-Quantum]
--

'''

**Mark Open University assignments without the pain.** No Java. No Windows-only. No Word dependency. Just works.

== Install

[cols="1,2"]
|===
|Platform |Command

|**Linux/macOS**
|`curl -fsSL https://hyperpolymath.github.io/tma-mark2/install \| bash`

|**Windows**
|`irm https://hyperpolymath.github.io/tma-mark2/install.ps1 \| iex`

|**Already have Podman?**
|`podman run -p 4000:4000 ghcr.io/hyperpolymath/etma-handler`
|===

Then open http://localhost:4000. Done.

== What You Need

* **Podman** - That's it. The container has everything else.

[cols="1,2"]
|===
|Platform |Install Podman

|Fedora |`sudo dnf install podman`
|Ubuntu |`sudo apt install podman`
|Arch |`sudo pacman -S podman`
|macOS |`brew install podman`
|Windows |`winget install RedHat.Podman`
|===

== What This Is

eTMA Handler replaces the legacy Java marking tool for Open University tutors:

[cols="1,1"]
|===
|Old Java Tool |eTMA Handler

|Windows only |Linux, macOS, Windows
|Requires Java 6 |Requires nothing (container)
|Word-dependent |Built-in annotation
|Clunky file handler |Drag and drop
|Manual PT3 forms |Auto-generated
|No batch release |Release all at once
|===

== Commands

[source,bash]
----
just do-it      # Set everything up and run
just start      # Run in background
just stop       # Stop the container
just update     # Update to latest version
just backup     # Backup your data
just logs       # View logs
just status     # Check if running
----

== Your Data

Your data stays on your machine:

[source]
----
Linux/macOS: ~/.local/share/etma_handler/
Windows:     %APPDATA%\etma_handler\
----

Override with: `ETMA_DATA_DIR=/your/path just do-it`

== For Developers

If you want to hack on the code:

[source,bash]
----
# Enter dev environment (requires Nix)
nix develop

# Or install Elixir and run
mix deps.get
mix phx.server
----

Development requires:

* Elixir 1.16+ / OTP 26+
* Node.js 20+
* Or just use: `nix develop`

== How It Works

[source]
----
┌─────────────────────────────────────────────────────────────┐
│                     Your Computer                            │
│  ┌─────────────────────────────────────────────────────┐    │
│  │              Podman Container                        │    │
│  │  ┌─────────────┬─────────────┬──────────────┐       │    │
│  │  │   Phoenix   │   Elixir    │    CubDB     │       │    │
│  │  │  LiveView   │   Logic     │   Storage    │       │    │
│  │  └─────────────┴─────────────┴──────────────┘       │    │
│  │               Wolfi Base (minimal)                   │    │
│  └─────────────────────────────────────────────────────┘    │
│                            │                                 │
│                    ┌───────┴───────┐                        │
│                    ▼               ▼                        │
│              http://localhost:4000                          │
│               ~/.local/share/etma_handler (your data)       │
└─────────────────────────────────────────────────────────────┘
----

The container bundles:

* Wolfi base (minimal, secure)
* Erlang/OTP runtime
* Elixir release
* Phoenix web app
* All dependencies

Your data lives outside the container. Update the container, keep your data.

== Security

**Your marking data deserves Fort Knox-level protection.**

eTMA Handler implements defense-in-depth cryptography using best-in-class algorithms:

=== Encryption (Post-Quantum Hybrid)

[cols="1,2,1"]
|===
|Algorithm |Purpose |Security

|**ML-KEM-1024**
|Key encapsulation (NIST FIPS 203)
|Post-quantum safe

|**X25519**
|Classical ECDH (defense-in-depth)
|~128-bit

|**XChaCha20-Poly1305**
|Authenticated encryption
|256-bit key, 192-bit nonce
|===

*Hybrid encryption* means an attacker must break **both** ML-KEM-1024 (quantum-safe) and X25519 (classical) to decrypt your data.

=== Signatures

[cols="1,2,1"]
|===
|Algorithm |Purpose |Security

|**Ed448**
|Primary signatures (SHAKE256)
|~224-bit

|**Ed25519**
|Fallback for older systems
|~128-bit
|===

=== Hashing

[cols="1,2,1"]
|===
|Algorithm |Purpose |Speed

|**BLAKE3**
|General hashing, KDF (default)
|5x faster than SHA-256

|**SHA3-512**
|Maximum security margin
|~256-bit security

|**SHAKE256**
|Variable-length XOF
|Ed448 signatures
|===

=== Password & Authentication

[cols="1,2"]
|===
|Technology |Properties

|**Argon2id**
|Memory-hard (64MB), 3 iterations, side-channel resistant

|**FIDO2/WebAuthn**
|Hardware keys, biometrics, passkeys (phishing-resistant)
|===

=== Algorithm Summary

[source]
----
Encryption:     ML-KEM-1024 + X25519 → XChaCha20-Poly1305
Signatures:     Ed448 (primary) / Ed25519 (fallback)
Hashing:        BLAKE3 / SHA3-512 / SHAKE256
Passwords:      Argon2id (64MB, 3 iterations)
Authentication: FIDO2/WebAuthn (YubiKey, Touch ID, Passkeys)
Key Derivation: BLAKE3-KDF / HKDF-SHA256
----

=== Zero Trust

* **Data at rest**: Encrypted with hybrid post-quantum crypto
* **Passwords**: Argon2id (defeats GPU attacks)
* **2FA**: FIDO2 hardware keys or passkeys
* **No telemetry**: Zero data collection

== Documentation

* link:ROADMAP.md[Roadmap] - Where we're going
* link:CONTRIBUTING.adoc[Contributing] - How to help
* link:SECURITY.md[Security] - Vulnerability reporting
* link:docs/COMPETITORS.md[Competitors] - Market analysis
* link:docs/IDEAS.md[Ideas] - Innovation brainstorm
* link:CLAUDE.adoc[AI Guide] - For AI assistants

== License

MIT License - see link:LICENSE.txt[LICENSE.txt]

== Acknowledgements

* The Open University for the original (and the pain that inspired this)
* The Elixir and Phoenix communities
* Chainguard for Wolfi
* Every tutor who's ever rage-quit the Java tool
